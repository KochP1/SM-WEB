<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js" integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="../static/styles.css">
    <title>Inbox</title>
</head>
<body class="body-tiendas">

    <nav class="navbar navbar-expand-lg bg-light">
        <div class="container-fluid">
            <a class="navbar-brand fw-bolder" href="inbox.html">Gestionar fallas</a>
            <span>Bienvenido/a {{session['name']}} {{session['surname']}} <a href="{{url_for('logout')}}" class="mx-3">Salir</a></span>
        </div>
    </nav>


    <div class="container">
        <div class="card mt-3 w-25 mx-auto d-block container__container">
            <div class="d-flex date-input__container">
                <form action="/date-filter" class="btn__form" method='post'>
                    <label>Filtrar por fecha</label>
                    <input type="date" class="form-control mb-3" placeholder="yyyy-mm-dd" min="2025-01-01" name="fecha-1">
                    <input type="date" class="form-control mb-3" placeholder="yyyy-mm-dd" min="2025-01-01" name='fecha-2'>
                    <button type="submit" class="btn btn-primary w-100">Buscar</button>
                </form>
            </div>
        </div>

        <!-- Reportes -->
        <div class="row row-col-1 row-cols-sm-1 row-cols-md-3 row-cols-lg-4 mt-3">
            {% for falla in fallas %}
               <div class="col-md-3 contenedor-reporte">
                <div class="card card-falla">
                    <div class="card-header">
                        <label>{{falla.tienda}}</label>
                    </div>
                    <div class="card-body">
                        <div class="card-item">
                            <label>Encargado:</label>
                            {{falla.name}} {{falla.surname}}
                        </div>
                        <div class="card-item">
                            <label>Area:</label>
                            {{falla.area}}
                        </div>

                        <div class="card-item item-mb">
                            <label>Tipo:</label>
                            {{falla.tipo}}
                        </div>

                        <div class="card-item">
                            <label>Descripcion:</label>
                            {{falla.descripcion}}
                        </div>
                    </div>

                    <div class="card-footer d-flex justify-content-between">
                        {{falla.fecha}}
                        <form action="/delete-falla" method="post">
                            <input type="hidden" value="{{falla.id}}" name="id">
                            <button type="submit" class="btn btn-outline-danger btn-sm">Eliminar</button>
                        </form>
                    </div>
                </div>
               </div>
            {% endfor %}
         </div>
    </div>

        <script>
            // Obtener el input de fecha
      var inputFecha = document.getElementById('fecha');
    
    // Mostrar un selector de fecha personalizado
      inputFecha.addEventListener('focus', function() {
        var datepicker = new Datepicker(inputFecha, {
            format: 'yyyy-mm-dd',
            autohide: true
        });
      });
    
    // Convertir y mostrar la fecha en el formato deseado antes de enviarla al servidor
      inputFecha.addEventListener('change', function() {
        var dateParts = inputFecha.value.split('-');
        var formattedDate = dateParts[2] + '-' + dateParts[1] + '-' + dateParts[0];
        console.log(formattedDate); // Esta es la fecha en el formato yyyy-mm-dd
      });
    </script>
</body>
</html>